<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'
     xmlns:h='http://java.sun.com/jsf/html'
     xmlns:f='http://java.sun.com/jsf/core'
     xmlns:c="http://java.sun.com/jsp/jstl/core"
     xmlns:p="http://primefaces.org/ui"
     xmlns:ui="http://java.sun.com/jsf/facelets">

    <h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    </h:head>
    
    <body>
	<ui:composition>
	<div class="row">
            <div class="span3">
                <img src="img/gallery/gallery-img-1-full.jpg" alt="Gallery"/>
            </div>
            
            <div class="span6" >
                <h2>#{user.lastName} #{user.firstName}</h2>
                <p class="lead">#{cv.title}</p>
                <p>#{cv.description}</p>
		<h:form id="addFriendSendMsgButtons">
		    <p>
			<c:if test="#{user ne loginMBean.currentUser and !friendMBean.alreadyFriendWith(user)}">
			    <p:commandButton disabled="#{user eq loginMBean.currentUser or friendMBean.alreadyFriendWith(user)}" styleClass="btn btn-large btn-success" value="Ajouter en ami" action="#{friendMBean.sendRequest}" ajax='true' update="addFriendSendMsgButtons">
				<f:param name="id" value="#{user.id}"/>
			    </p:commandButton>
			</c:if>
			<h:commandLink  id="sendMsgButton" styleClass="btn btn-large btn-info" value="Envoyer un message"  action="/messenger-new.xhtml?faces-redirect=true" >
			    <f:setPropertyActionListener target="#{messageMBean.subject}" value=""/>
			    <f:setPropertyActionListener target="#{messageMBean.content}" value=""/>
			</h:commandLink>
		    </p>
		</h:form>		
            </div>

            <div class="span3">
                <p><i class="icon-envelope"></i>#{user.email}</p>
                
            </div>
        </div>
	
	<h3 class="title-bg">Compétences</h3>
        <div class="row"> 
	    <h:form id="cvSkills" styleClass="span12 removeBackground">
		<p:dataGrid id="skills" var="skill" value="#{userSkillMBean.getUserSkillsByUser(user)}" emptyMessage="Aucune compétence à afficher." columns="4" layout="grid" paginator="false">
		    <p:panel style="text-align:center">
			<h:panelGrid columns="1" style="width:100%">
			    <h6>#{skill.skill.name}</h6>
			    <p>#{skill.description}</p>
			    <div class="progress progress-#{skill.mark le 25 ? 'danger' : skill.mark le 50 ? 'warning' : skill.mark le 75 ? 'info' : skill.mark le 100 ? 'success' : ''} progress-striped">
				<div class="bar" style="width: #{''.concat(skill.mark).concat('%')};">#{skill.mark}%</div>
			    </div>
			</h:panelGrid>
		    </p:panel>
		</p:dataGrid>
	    </h:form>
        </div>
	
	<h:form id="cvSections" styleClass="removeBackground">
	    <p:dataGrid id="sections" var="section" value="#{sectionMBean.getUserSectionsByUser(user)}" emptyMessage="Aucune section à afficher." columns="1" layout="grid" paginator="false">	
		<h3 class="title-bg">#{section.title}</h3>
		 
		    <p:dataGrid id="elements" var="element" value="#{sectionMBean.getElementsBySection(section)}" emptyMessage="Aucun élément dans la section." columns="1" layout="tabular" paginator="false">	
			    <div class="span8">
				<h4>#{element.title}</h4>
				<b>#{element.description}</b><br/>
				<i>#{element.informations}</i>
			    </div>
			
			     <div class="span4" style="text-align: right;">
				 <p>#{element.dateStart} - #{element.dateEnd}</p>
			     </div>
		    </p:dataGrid>
		
	    </p:dataGrid>
	</h:form>
	</ui:composition>
    </body>
</html>